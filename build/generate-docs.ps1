# Documentation is auto-generated by DocFx.
# We need to install the tools and then auto-generate the documentation from the ~/doc folder.
# The generated files are then published as a Build Artifact and processed by a Release Pipeline.

if ([string]::IsNullOrEmpty(($env:BUILD_ARTIFACTSTAGINGDIRECTORY))) {
    Write-Host "BUILD_ARTIFACTSTAGINGDIRECTORY was not set. Not generating documentation."
    return
}

$targetDir = [System.IO.Path]::Combine(
    $env:BUILD_ARTIFACTSTAGINGDIRECTORY,
    "Documentation"
)

Write-Host "Installing DocFx..."
choco install docfx -y
Write-Host "DocFx installed."

Write-Host "Generating documentation..."
Set-Location doc
docfx -o "$targetDir"
Write-Host "Generated documentation."